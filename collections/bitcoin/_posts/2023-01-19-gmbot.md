---
layout: post
title: "How to build a nostr gm bot"
description: "(without writing any code)"
date: 2023-01-19
blocktime: TODO
image: /assets/images/gmbot.jpg
redirect_from: /gmbot
author: Gigi
category: bitcoin
favorite: true
tags:
 - Bitcoin
 - Writing
 - Tutorial
 - nostr
---




I've been bullish on nostr for a while now, but even I am surprised by how swift the ecosystem around this open protocol has been growing. Yes, it's still early days. But it's the perfect time to poke around and ~~break~~ build things. How else would you explore and learn?

So, after porting my [two](https://www.nostr.guru/p/npub1satst5p5jcacfpagy3jxscf2s48d9dd0v6lfxms7frp9e6t2w5xstmsfjp) [bots](https://www.nostr.guru/p/npub1satsv3728d65nenvkmzthrge0aduj8088dvwkxk70rydm407cl4s87sfhu) to nostr, I thought why not write a little guide that shows how the sausage is made. 

Here's what we're going to do, in short:

- **The goal:** build a bot that says "gm" every morning.
- **The approach:** run [noscl](https://github.com/fiatjaf/noscl) in a cron job that's set to 6:15 am
- **The prerequisites:** a linux system and knowing your way around the command line a bit.

We'll use Ubuntu Server, as it is widely available. I assume that you are logged in as a non-root user. If you're logged in as root, I assume that you know what you're doing (so you'll know to omit `sudo` and stuff).

## 1) Create dedicated bot user

We will create a dedicated user on our system. 
Let's call him "gmbot". 
I'll let you pick the password.

    $ sudo useradd -d /home/gmbot -m gmbot
    $ sudo passwd gmbot

We'll also want to add the user to the sudoers group:

		$ sudo usermod -aG sudo gmbot

Great, done. On to using the user!

## 2) Log in as bot user



```
$ su gmbot
```

Go Home

		gmbot$ cd ~

## 3) Install go

```
$ sudo snap install go  --classic
```

If you want to avoid snap, you can also install it [from source](https://www.digitalocean.com/community/tutorials/how-to-install-go-on-ubuntu-20-04) or via a [PPA](https://askubuntu.com/a/1377308).

Whatever you use to install it, make sure that `go` works:

```
$ go version
go version go1.19.5 linux/amd64
```

If you see a similar output for `go version` we can move on to the next step. Paths!


## 4) Define go path

Edit your `.bashrc` with the editor of your choice...

```
$ vim ~/.bashrc
```

... and set the go path by adding the following at the end of the file:

```
# Set go path to user's home directly
export GOPATH=$HOME/go
export PATH=$PATH:$GOROOT/bin:$GOPATH/bin
```

Save, exit, and load it up:

```
$ source ~/.bashrc
```


## 5) Install noscl

We're going to use fiatjaf's noscl client to post notes and stuff. Install it via

```
$ go install github.com/fiatjaf/noscl@latest
```

Try it!


```
$ noscl
> can't open config file /home/gmbot/.config/nostr/config.json: open /home/gmbot/.config/nostr/config.json: no such file or directory
```


Uh-oh, that's not good. The config directory does not exist, so `noscl` can't create the config file it needs. Let's fix this by creating it!

```
$ mkdir -p ~/.config/nostr
```

Now noscl should work. Run

```
$ noscl
```


...and you should see a "usage" text as follows:

```
Usage:
  noscl home
  noscl setprivate <key>
  noscl sign <event-json>
  noscl verify <event-json>
	...
```

We're going to do a `noscl setprivate` next, which will put the private key of our bot into the config file, effectively creating the bot account on the nostr protocol. (Side note: if an account is created in the woods, but never publishes a note, does it even exist?)

## 6) Create the bot

You can create your key by rolling some dice. If you don't have any dice handy, you can also use `noscl key-gen` to generate the private key for your bot.

```
$ noscl key-gen
```

It will produce an output like this:

```
seed: armed birth test cargo ... orchard autumn
private key: fc4b95d1....c5b98bd
```

Copy-paste the private key and set it via `noscl setprivate`. Unless you hate yourself. If you hate yourself, type it in by hand.

```
$ noscl setprivate <THE_PRIVATE_KEY_YOU_GENERATED_ABOVE>
```

You'll have to use your actual private key, not `<THE_PRIVATE_KEY_YOU_GENERATED_ABOVE>`. Easy mistake to make!

## 7) Say "Good morning!"

Let's pretend it's 6:15 am. Time to say "good morning."

You could try to scream "good morning" into the void, but `noscl` will scream at you, telling you that you have zero relays set up. No relays, no party. We need to add at least one relay to talk to the nostrverse, so let's add everyone's favourite relay: your mom.

```
$ noscl relay add wss://nostr.mom
```

If successful, you'll see something like

```
> Added relay wss://nostr.mom.
```

You don't have to use this exact relay, and you're free to add multiple relays. Consult [nostr.watch](https://nostr.watch/relays/find#public) for a list of public relays.

Time to publish our first "good morning!"

```
noscl publish "Good morning!"
```

If successful, you should see something like:

```
> Sent event 4869429dcc20bd87567e3370c577793aac58f66bb07d130562738285dee6569f to 'wss://nostr.mom'.
```

You can use a "nostr explorer" like [nostr.guru](https://www.nostr.guru/e/4869429dcc20bd87567e3370c577793aac58f66bb07d130562738285dee6569f) to look up the event, i.e. the note you just published. It might take a minute to show up, but if everything worked, you should see it staring back at you:

TODO Insert image

https://www.nostr.guru/e/4869429dcc20bd87567e3370c577793aac58f66bb07d130562738285dee6569f

## 8) Automate with crontab

Still logged in as the `gmbot` user, edit the user-level crontab with

```
$ crontab -e
```

...and add the following line:[^fn-crontab]

[^fn-crontab]: If you're having trouble making sense of the crontab syntax, [crontab.guru](https://crontab.guru/#15_6_*_*_*) is a useful tool.

```bash
15 6 * * * /home/gmbot/go/bin/noscl publish "Good morning!"
```

Save the file & exit, and crontab should tell you that it is installing a new
crontab. Very kind of crontab, but also very redundant.

```bash
crontab: installing new crontab
```

That's it!

Now every morningâ€”as long as the server that you used to set all this up is
runningâ€”the bot you created will great the world with an censorship-resistant
"Good morning!"

You can use the private key of your bot to update the profile metadata, i.e. set
a name, description, profile picture, banner, and so on. You can even give your
bot a lightning address, just like I did! `gmbot@ts.dergigi.com`

`gmbot` is live as `npub1gmgmj6punek0gjp6s26e0d5nfumghmszeg33vgqzs6vhn0x0vq3q5mdaxm` 

GM ðŸŒ…ðŸ¤™

---

